<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦™æ¸¯ 2026 è¡Œç¨‹è¨ˆç•« - é›¶è²»ç”¨å°èˆªç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        /* ç¢ºä¿ Vue App èƒ½å¤ å¡«æ»¿ç•«é¢ */
        #app { min-height: 100vh; }
    </style>
</head>
<body>

<div id="app" class="bg-gray-50">
    <div v-show="isMenuOpen" @click="toggleMenu" class="fixed inset-0 bg-black bg-opacity-50 z-40"></div>
    <div :class="{'translate-x-0': isMenuOpen, 'translate-x-full': !isMenuOpen}" 
         class="fixed right-0 top-0 w-64 bg-white shadow-lg p-6 h-full z-50 transition-transform duration-300">
        <h3 class="text-xl font-bold mb-4">åŠŸèƒ½é¸å–®</h3>
        <ul>
            <li v-for="menu in menuOptions" :key="menu.name" 
                @click="menu.action" 
                class="py-2 cursor-pointer hover:bg-gray-100 rounded px-2">
                {{ menu.name }}
            </li>
        </ul>
    </div>

    <div class="max-w-md mx-auto bg-white shadow-lg relative">

        <div class="p-4 pt-8 bg-pink-50 relative overflow-hidden">
            <button @click="isEditMode = !isEditMode" 
                    class="absolute top-4 left-4 p-2 bg-white rounded-full shadow-md text-sm font-semibold flex items-center">
                <span :class="{'text-red-500': isEditMode, 'text-gray-600': !isEditMode}">
                    {{ isEditMode ? 'ç·¨è¼¯æ¨¡å¼' : 'ç€è¦½æ¨¡å¼' }}
                </span>
            </button>
            
            <button @click="toggleMenu" class="absolute top-4 right-4 p-2 bg-white rounded-full shadow-md text-xl">
                â˜°
            </button>

            <div class="h-40 flex justify-center items-center">
                <img src="./Gemini_Generated_Image_y689rxy689rxy689.jpg" alt="é¦™æ¸¯è¡—æ™¯æ’ç•«" class="w-full h-auto object-cover">
            </div>

            <div class="mt-4 p-3 bg-white rounded-lg shadow-md flex items-center space-x-3">
                <span class="text-2xl">â˜€ï¸</span>
                <div>
                    <p class="text-sm">æ°£æº«: {{ weather.temp }}Â°C / é«”æ„Ÿ: {{ weather.feel }}Â°C</p>
                    <p class="text-xs text-blue-500">å»ºè­°ç©¿è‘—: {{ weather.clothing }}</p>
                </div>
            </div>
        </div>

        <div class="p-4">
            <h2 class="text-xl font-bold mb-4 border-b pb-2">æ¯æ—¥è¡Œç¨‹è¡¨</h2>
            
            <div v-for="(day, dayIndex) in trips" :key="dayIndex" class="mb-6 p-4 border rounded-lg shadow-sm bg-white">
                <h3 class="text-lg font-semibold mb-3">Day {{ dayIndex + 1 }} - {{ day.date.split('/')[1] }}/{{ day.date.split('/')[2] }}</h3>

                <div v-for="(item, itemIndex) in day.items" :key="itemIndex" 
                     :class="{'bg-yellow-50': isEditMode}" 
                     class="relative p-3 mb-3 border-l-4 border-blue-400 rounded-md">
                    
                    <div v-if="!item.isEditing">
                        <p class="font-bold">{{ item.time }} - {{ item.location }}</p>
                        <p class="text-sm text-gray-600">{{ item.activity }}</p>
                        <p v-if="item.transportDuration" class="text-xs text-green-500 mt-1">
                            äº¤é€š: {{ item.transportDuration }}
                        </p>
                        <div class="mt-2 space-x-2">
                            <button @click="openGoogleMaps(item.location)" 
                                    class="text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600">
                                å°èˆª ğŸ—ºï¸
                            </button>
                            <button v-if="isEditMode" @click="item.isEditing = true" 
                                    class="text-xs bg-gray-300 text-gray-700 px-2 py-1 rounded hover:bg-gray-400">
                                ç·¨è¼¯
                            </button>
                            <button v-if="isEditMode" @click="deleteItem(dayIndex, itemIndex)" 
                                    class="text-xs bg-red-400 text-white px-2 py-1 rounded hover:bg-red-500">
                                åˆªé™¤
                            </button>
                        </div>
                    </div>

                    <div v-else class="space-y-2">
                        <input v-model="item.time" type="time" class="w-full p-1 border rounded text-sm" placeholder="æ™‚é–“">
                        <input v-model="item.location" type="text" class="w-full p-1 border rounded text-sm" placeholder="åœ°é»">
                        <textarea v-model="item.activity" class="w-full p-1 border rounded text-sm" rows="2" placeholder="æ´»å‹•å…§å®¹"></textarea>
                        <input v-model="item.transportDuration" type="text" class="w-full p-1 border rounded text-sm" placeholder="äº¤é€šè€—æ™‚ (e.g., 30åˆ†é˜)">
                        <button @click="item.isEditing = false; updateFirebase()" 
                                class="w-full bg-green-500 text-white p-1 rounded text-sm hover:bg-green-600">
                            å„²å­˜
                        </button>
                    </div>
                </div>
                
                <button v-if="isEditMode" @click="addItem(dayIndex)" 
                        class="mt-3 w-full bg-green-200 text-green-800 p-2 rounded-lg font-semibold hover:bg-green-300">
                    + æ–°å¢æ™¯é»/ç¾é£Ÿ/æ´»å‹•
                </button>
            </div>

            <button v-if="isEditMode" @click="addDay" 
                    class="mt-4 w-full bg-purple-200 text-purple-800 p-3 rounded-lg font-semibold hover:bg-purple-300">
                + æ–°å¢è¡Œç¨‹æ—¥
            </button>
        </div>
    </div>
</div>

<script>
// =================================================================
// åˆå§‹è³‡æ–™çµæ§‹
// =================================================================
const initialData = {
    weather: {
        temp: 22,
        feel: 24,
        clothing: 'è–„å¤–å¥—ã€èˆ’é©é•·è¤²'
    },
    shopping: [
        { name: 'ç¾å¿ƒè›‹æ²', price: 120, bought: false },
        { name: 'çå¦®æ›²å¥‡', price: 150, bought: false },
    ],
    trips: [
        {
            date: '2026/01/20',
            items: [
                { time: '09:00', location: 'é¦™æ¸¯åœ‹éš›æ©Ÿå ´', activity: 'æŠµé”ã€å–è¡Œæ', transportDuration: '', isEditing: false },
                { time: '10:30', location: 'ä¸­ç’°è¡—å¸‚', activity: 'åˆé¤ï¼šé£²èŒ¶é»å¿ƒ', transportDuration: '30åˆ†é˜ (æ©Ÿå ´å¿«ç·š)', isEditing: false },
                { time: '14:00', location: 'å¤ªå¹³å±±é ‚', activity: 'æ­ä¹˜å±±é ‚çºœè»Šè§€å…‰', transportDuration: '20åˆ†é˜ (è¨ˆç¨‹è»Š)', isEditing: false },
            ]
        }
    ],
};

// =================================================================
// Vue æ‡‰ç”¨ç¨‹å¼é‚è¼¯
// =================================================================
const app = Vue.createApp({
    data() {
        return {
            // ==================================================
            // â—â—â— Firebase é…ç½® (å·²å¡«å…¥æ‚¨çš„æ•¸å€¼) â—â—â—
            // ==================================================
            firebaseConfig: {
                apiKey: "AIzaSyD-gOroKPdB2Ao0LDKNC1uEeTDcTRaAeao",
                authDomain: "hong-kong-2026.firebaseapp.com",
                databaseURL: "https://hong-kong-2026-default-rtdb.firebaseio.com",
                projectId: "hong-kong-2026",
                // é€™è£¡åªä¿ç•™äº†å¿…è¦çš„åƒæ•¸
            },
            database: null,
            
            // æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹
            isEditMode: false,
            isMenuOpen: false,

            // è³‡æ–™
            weather: initialData.weather,
            trips: initialData.trips,
            shoppingList: initialData.shopping,

            // é¸å–®é¸é …
            menuOptions: [
                { name: 'åˆ‡æ›ç·¨è¼¯æ¨¡å¼', action: () => { this.isEditMode = !this.isEditMode; this.isMenuOpen = false; } },
                { name: 'é–‹å•Ÿè³¼ç‰©æ¸…å–® (æœªå¯¦ä½œ)', action: () => alert('è³¼ç‰©æ¸…å–®åŠŸèƒ½æ­£åœ¨é–‹ç™¼ä¸­...') },
                { name: 'é‡è¨­è³‡æ–™', action: () => this.resetData() },
            ]
        };
    },
    mounted() {
        this.initializeFirebase();
        this.listenForChanges();
    },
    methods: {
        // --- Firebase ç›¸é—œæ–¹æ³• ---
        initializeFirebase() {
            if (!firebase.apps.length) {
                firebase.initializeApp(this.firebaseConfig);
            }
            // è¨­ç½®è³‡æ–™åº«åƒè€ƒé»
            this.database = firebase.database().ref('trips_data');
        },
        listenForChanges() {
            // å¾ Firebase è¼‰å…¥è³‡æ–™
            this.database.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    // ç¢ºä¿è¼‰å…¥æ™‚å¦‚æœç¯€é»ç‚ºç©ºï¼Œå‰‡ä½¿ç”¨åˆå§‹è³‡æ–™
                    this.trips = data.trips || initialData.trips;
                    this.shoppingList = data.shopping || initialData.shopping;
                    this.weather = data.weather || initialData.weather;
                } else {
                    // å¦‚æœ Firebase æ˜¯ç©ºçš„ï¼Œå‰‡ä¸Šå‚³åˆå§‹è³‡æ–™
                    this.updateFirebase();
                }
            });
        },
        updateFirebase() {
            // å°‡æ‰€æœ‰è³‡æ–™å¯«å› Firebase
            this.database.set({
                trips: this.trips,
                shopping: this.shoppingList,
                weather: this.weather
            }).catch(error => {
                console.error("Firebase å¯«å…¥å¤±æ•—:", error);
            });
        },
        resetData() {
            if (confirm('ç¢ºå®šè¦å°‡æ‰€æœ‰è¡Œç¨‹å’Œè³¼ç‰©æ¸…å–®é‡è¨­ç‚ºé è¨­å€¼å—ï¼Ÿ')) {
                // ä½¿ç”¨æ·±å±¤è¤‡è£½ç¢ºä¿é‡è¨­ä¸æœƒå½±éŸ¿åŸå§‹çš„ initialData çµæ§‹
                this.trips = JSON.parse(JSON.stringify(initialData.trips));
                this.shoppingList = JSON.parse(JSON.stringify(initialData.shopping));
                this.weather = JSON.parse(JSON.stringify(initialData.weather));
                this.updateFirebase();
            }
        },

        // --- UI/è¡Œç¨‹ç®¡ç†æ–¹æ³• ---
        toggleMenu() {
            this.isMenuOpen = !this.isMenuOpen;
        },
        addDay() {
            const nextDayNumber = this.trips.length + 1;
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + nextDayNumber - 1); // å‡è¨­å¾ä»Šå¤©é–‹å§‹
            const newDate = `${tomorrow.getFullYear()}/${String(tomorrow.getMonth() + 1).padStart(2, '0')}/${String(tomorrow.getDate()).padStart(2, '0')}`;
            
            this.trips.push({
                date: newDate,
                items: [
                    { time: '09:00', location: 'æ–°æ™¯é»', activity: 'æ–°å¢æ´»å‹•', transportDuration: '', isEditing: true }
                ]
            });
            this.updateFirebase();
        },
        addItem(dayIndex) {
            this.trips[dayIndex].items.push({
                time: '12:00', 
                location: 'æ–°åœ°é»', 
                activity: 'æ–°æ´»å‹•', 
                transportDuration: '', 
                isEditing: true 
            });
            this.updateFirebase();
        },
        deleteItem(dayIndex, itemIndex) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹è¡Œç¨‹é …ç›®å—ï¼Ÿ')) {
                this.trips[dayIndex].items.splice(itemIndex, 1);
                // å¦‚æœä¸€å¤©çš„é …ç›®éƒ½åˆªå®Œäº†ï¼Œä¹Ÿåˆªé™¤é€™ä¸€å¤© (å¯é¸)
                if (this.trips[dayIndex].items.length === 0) {
                    this.trips.splice(dayIndex, 1);
                }
                this.updateFirebase();
            }
        },
        
        // --- æ ¸å¿ƒå°èˆªå‡½å¼ (é›¶è²»ç”¨ç‰ˆæœ¬) ---
        openGoogleMaps(location) {
            if (location) {
                // ä½¿ç”¨ encodeURIComponent ç¢ºä¿åœ°é»åç¨±ä¸­çš„ç‰¹æ®Šå­—å…ƒè¢«æ­£ç¢ºç·¨ç¢¼
                const encodedLocation = encodeURIComponent(location);
                
                // æ§‹é€ æ¨™æº–çš„ Google åœ°åœ–æœå°‹ URL
                const mapUrl = `https://www.google.com/maps/dir/?api=1&destination=${encodedLocation}`;
                
                // åœ¨æ–°è¦–çª—ä¸­é–‹å•Ÿ
                window.open(mapUrl, '_blank');
            } else {
                console.error("ç„¡æ³•å°èˆªï¼šåœ°é»ç‚ºç©ºã€‚");
                alert("è«‹å…ˆè¼¸å…¥ä¸€å€‹åœ°é»åç¨±ã€‚");
            }
        }
    }
});

app.mount('#app');
</script>

</body>
</html>
